#!/usr/bin/env python
# -*- coding: utf-8 -*-

"""
-----------------------------------------
@Created: 2020/07/11
------------------------------------------
@Modify: 2020/07/11
------------------------------------------
@Description:
定义相关配置
"""

import sys, os, inspect, logging
from vulnerability_analysis.utility import log

# ================= output path ====================
# ================= output path ====================
current_dir = os.path.dirname(os.path.abspath(inspect.getfile(inspect.currentframe())))
parent_dir = os.path.dirname(current_dir)
PROJECT_ROOT = parent_dir.rstrip('/') + '/'
print('PROJECT_ROOT', PROJECT_ROOT)
OUTPUT_PATH = PROJECT_ROOT + 'output/'

# ================= 设置&开关 ====================
# ================= 设置&开关 ====================
# 设置项目log level，如： logging.INFO
LOG_LEVEL = logging.DEBUG
SWITCH_DR010_ANALYSE_RDG_COMMENTS_REDHAT_REQUEST_URL_IF_NOT_IN_DB = False
SWITCH_DR010_ANALYSE_NVD_REF_REQUEST_AND_IDENTIFY_DIFF_TEXT_IN_EXTRACT_COMMIT = True
CRAWL_OPTION1_REQUEST_ONLINE = True

# ================= log ====================
LOG_FILE_PATH = OUTPUT_PATH + 'log/test.log'
# LOGGER = log.create_logger(logging.DEBUG, LOG_FILE_PATH)
LOG_CRAWLING_REDHAT_ADVISORIES_PATH = OUTPUT_PATH + 'log/crawling_redhat_advisories.log'
LOG_PARSING_REDHAT_ADVISORIES_PATH = OUTPUT_PATH + 'log/parsing_redhat_advisories.log'

LOG_CRAWLING_GENTOO_ADVISORIES_PATH = OUTPUT_PATH + 'log/crawling_gentoo_advisories.log'
LOG_PARSING_GENTOO_ADVISORIES_PATH = OUTPUT_PATH + 'log/parsing_gentoo_advisories.log'
LOG_CRAWLING_GENTOO_VULNERABILITY_REPORT_PATH = OUTPUT_PATH + 'log/crawling_gentoo_vulnerability_report.log'
LOG_CRAWLING_GENTOO_ATTACHMENT_PATH = OUTPUT_PATH + 'log/crawling_gentoo_attachment.log'
LOG_PARSING_GENTOO_ALL_INFORMATION_PATH = OUTPUT_PATH + 'log/parsing_gentoo_all_information.log'

LOG_CRAWLING_DEBIAN_ADVISORIES_PATH = OUTPUT_PATH + 'log/crawling_debian_advisories.log'
LOG_PARSING_DEBIAN_ADVISORIES_PATH = OUTPUT_PATH + 'log/parsing_debain_advisories.log'
LOG_CRAWLING_DEBIAN_VULNERABILITY_REPORT_PATH = OUTPUT_PATH + 'log/crawling_debian_vulnerability_report.log'
LOG_CRAWLING_GITHUB_ALL_INFORMATION_PATH = OUTPUT_PATH + 'log/crawling_github_all_information.log'

LOG_CRAWLING_GITHUB_ISSUE_PATH = OUTPUT_PATH + 'log/crawling_github_issue.log'

LOG_ANALYSE_PATCH_METADATA_PATH = OUTPUT_PATH + 'log/redhat_extended_CVEIDs_reports.json'

LOG_API_GATEWAY_SERVER = OUTPUT_PATH + 'log/api_gateway_server.log'

# utility
LOG_NVD_UTIL = OUTPUT_PATH + 'log/utility_NVD_util.log'
LOG_CRAWL_UTIL = OUTPUT_PATH + 'log/utility_crawl_util.log'
LOG_GITHUB_UTIL = OUTPUT_PATH + 'log/utility_github_util.log'

LOG_PATCH_COLLECT_MAIN = OUTPUT_PATH + 'log/DR010_patch_collect_main.log'
LOG_COLLECT_SVN_GIT_MAP_PATH = OUTPUT_PATH + 'log/DR010_collect_svn_git_id_map.log'
LOG_ANALYSE_RDG_COMMENTS_PATH = OUTPUT_PATH + 'log/DR010_analyse_RDG_comments.log'
LOG_ANALYSE_RDG_COMMENTS_ISSUE_FOR_PATCH_PATH = OUTPUT_PATH + 'log/DR010_analyse_RDG_comments_issue_for_patch.log'
LOG_ANALYSE_DEBIAN_NOTE_PATH = OUTPUT_PATH + 'log/DR010_analyse_Debian_note.log'
LOG_ANALYSE_DEBIAN_NOTE_ISSUE_FOR_PATCH_PATH = OUTPUT_PATH + 'log/DR010_analyse_Debian_note_issue_for_patch.log'
LOG_ANALYSE_NVD_REF_PATH = OUTPUT_PATH + 'log/DR010_analyse_NVD_ref.log'
LOG_ANALYSE_NVD_REF_PATCH_FOR_PATCH_PATH = OUTPUT_PATH + 'log/DR010_analyse_NVD_ref_patch_for_patch.log'
LOG_ANALYSE_NVD_REF_ISSUE_FOR_PATCH_PATH = OUTPUT_PATH + 'log/DR010_analyse_NVD_ref_issue_for_patch.log'
LOG_ANALYSE_NVD_REF_VADVISORY_FOR_PATCH_PATH = OUTPUT_PATH + 'log/DR010_analyse_NVD_ref_Vadvisory_for_patch.log'
LOG_ANALYSE_NVD_REF_VADVISORY_ISSUE_FOR_PATCH_PATH = OUTPUT_PATH + 'log/DR010_analyse_NVD_ref_Vadvisory_issue_for_patch.log'
LOG_SEARCH_GITHUB_FOR_COMMITS_PATH = OUTPUT_PATH + 'log/DR010_search_github_for_commits.log'
LOG_SEARCH_GITHUB_ISSUE_FOR_COMMITS_PATH = OUTPUT_PATH + 'log/DR010_search_github_issue_for_commits.log'
LOG_DIFF_REF_PATH = OUTPUT_PATH + 'log/DR010_diff_ref.log'
LOG_NOT_DIFF_REF_PATH =  OUTPUT_PATH + 'log/DR010_not_diff_ref.log'
LOG_ANALYSE_MANAGER_PATH = OUTPUT_PATH + 'log/DR010_analyse_manager.log'

# DR008
LOG_DR008_DOWNLOAD_AND_PARSE_NVD = OUTPUT_PATH + 'log/DR008_download_and_parse_NVD.log'
LOG_DR008_DOWNLOAD_AND_PARSE_NVD_CPE_RANGE = OUTPUT_PATH + 'log/DR008_download_and_parse_NVD_cpe_range.log'
LOG_DR008_AUTO_UPDATE_NVD_DATASET_MANAGER = OUTPUT_PATH + 'log/DR008_auto_update_nvd_dataset_manager.log'

# patch localization
LOG_PATCH_LOCALIZATION_TOOL_MANAGER = OUTPUT_PATH + 'log/patch_localization_tool_manager.log'

# analysis reference tag
CVE_REFERENCE_PATH = OUTPUT_PATH + 'processed_dataset/CVEItems_reference.json'
CVE_WITH_PATCH_TAG_PATH = OUTPUT_PATH + 'processed_dataset/CVEItems_with_PatchTag.json'
CVE_WITH_MITIGATION_TAG_PATH = OUTPUT_PATH + 'processed_datasetCVEItem_with_Mitigationtag.json'
CVE_WITH_VENDOR_ADVISORY_TAG_PATH = OUTPUT_PATH + 'processed_dataset/CVEItem_with_VendorAdvisorytag.json'
CVE_WITH_ISSUE_TRACKING_TAG_PATH = OUTPUT_PATH + 'processed_dataset/CVEItem_with_IssueTrackingtag.json'
CVE_WITH_COMMIT_REFERENCE_TAG_PATH = OUTPUT_PATH + 'processed_dataset/CVEItem_with_CommitReference.json'
CVE_WITH_THIRD_PARTY_ADVISORY_TAG_PATH = OUTPUT_PATH + 'processed_dataset/CVEItem_with_ThirdPartyAdvisory.json'

# ================= Patch localization output ====================
PATCH_LOCALICATION_OUTPUT_DIR = OUTPUT_PATH + 'patch_localization/'
PATCH_LOCALICATION_OUTPUT_CVE_PATCH_OBJ_PATH = PATCH_LOCALICATION_OUTPUT_DIR + 'cve_patch_objs/%s'
PATCH_LOCALICATION_OUTPUT_CVE_GRAPH_PATH = PATCH_LOCALICATION_OUTPUT_DIR + 'cve_url_graphs/%s.png'
PATCH_LOCALICATION_OUTPUT_CVE_EXE_LOG_PATH = PATCH_LOCALICATION_OUTPUT_DIR + 'cve_exe_logs/%s.log'
PATCH_LOCALICATION_OUTPUT_EVALUATE_PATH = PATCH_LOCALICATION_OUTPUT_DIR + 'evaluate.log'
PATCH_LOCALICATION_OUTPUT_SPECIAL_LOG_PATH = PATCH_LOCALICATION_OUTPUT_DIR + 'special_info.log'

# ================= DRxxx output ====================
# DRxxx output data
DR007_STEP2_RELATED_CVE_FROM_NVDAPI_PATH = OUTPUT_PATH + 'DR007/step2RelatedCVEsFromNVDAPI.json'
DR007_STEP3_Filtered_CVE_PATH = OUTPUT_PATH + 'DR007/step3FilteredCVEs.json'
DROO7_RESULT_PATH = OUTPUT_PATH + 'DR007/retrieve_CVE_result.json'
DR007_MATCHER_SERVER_LOG = OUTPUT_PATH + 'DR007/matcher_server_log.log'

DR008_CPE_AFFECTED_PRODUCTS_MAP_PATH = OUTPUT_PATH + 'DR008/CPE_cve_affectedProducts_map.json'
DR008_GitRepo_AFFECTED_PRODUCTS_MAP_PATH = OUTPUT_PATH + 'DR008/GitRepo_cve_affectedProducts_map.json'

DR009_CVE_AFFECTD_PACKAGES_FROM_MULTIPLE_SOURCES_PATH = OUTPUT_PATH + 'DR009/CVEID_affectedPackages_from_multipleSources.json'
DR009_CVE_OSS_COMPONENT_MAP_PATH = OUTPUT_PATH + 'DR009/cve_oss_component_map.json'
DR009_OSS_MATCHED_CVE_LIST_PATH = OUTPUT_PATH + 'DR009/matched_cve_list.json'

# known cve-package map
DR009_KNOWN_CVE_PKG_MAP_LANGUAGES = {'all', 'java', 'javascript', 'python'}
DR009_KNOWN_CVE_PKG_MAP_DIR = OUTPUT_PATH + 'DR009/known_cve_pkg_map/'
DR009_KNOWN_CVE_PKG_MAP_GITHUB_PATH = DR009_KNOWN_CVE_PKG_MAP_DIR + 'known_%s_cve_pkg_map_github.json'
DR009_KNOWN_CVE_PKG_MAP_HUAWEI_PATH = DR009_KNOWN_CVE_PKG_MAP_DIR + 'known_%s_cve_pkg_map_huawei.json'
DR009_KNOWN_CVE_PKG_MAP_SOURCE_PATH = DR009_KNOWN_CVE_PKG_MAP_DIR + 'known_%s_cve_pkg_map_%s.json'
DR009_KNOWN_CVE_PKG_MAP_FDSE_PATH = DR009_KNOWN_CVE_PKG_MAP_DIR + 'known_%s_cve_pkg_map_fdse.json'
DR009_KNOWN_JAVA_CVE_PKG_MAP_FDSE_PATCH_PATH = DR009_KNOWN_CVE_PKG_MAP_DIR + 'known_java_cve_pkg_map_fdse_patch.json'
DR009_KNOWN_JAVA_CVE_PKG_MAP_FDSE_NO_PATCH_PATH = DR009_KNOWN_CVE_PKG_MAP_DIR + 'known_java_cve_pkg_map_fdse_no_patch.json'
DR009_CVE_DATA_OF_FIELDS_PATH = DR009_KNOWN_CVE_PKG_MAP_DIR + 'cve_data_of_fields.json'
DR009_KNOWN_JAVA_CVE_PKG_MAP_FDSE_ARTIFICIAL_PATH = PROJECT_ROOT + 'data/fdse/known_java_cve_pkg_map_fdse_artificial_20210630.json'
DR009_KNOWN_JAVASCRIPT_CVE_PKG_MAP_FDSE_ARTIFICIAL_PATH = PROJECT_ROOT + 'data/fdse/known_javascript_cve_pkg_map_fdse_artificial_20210630.json'
DR009_KNOWN_PYTHON_CVE_PKG_MAP_FDSE_ARTIFICIAL_PATH = PROJECT_ROOT + 'data/fdse/known_python_cve_pkg_map_fdse_artificial_20210630.json'
DR009_KNOWN_JAVA_CVE_PKG_MAP_FDSE_ARTIFICIAL_THESIS_PATH = PROJECT_ROOT + 'data/fdse/known_java_cve_pkg_map_fdse_artificial_thesis_20210828.json'
DR009_KNOWN_JAVASCRIPT_CVE_PKG_MAP_FDSE_ARTIFICIAL_THESIS_PATH = PROJECT_ROOT + 'data/fdse/known_javascript_cve_pkg_map_fdse_artificial_thesis_20210828.json'
DR009_KNOWN_PYTHON_CVE_PKG_MAP_FDSE_ARTIFICIAL_THESIS_PATH = PROJECT_ROOT + 'data/fdse/known_python_cve_pkg_map_fdse_artificial_thesis_20210828.json'
DR009_TEST_CVE_PKG_MATCHER_RESULT = DR009_KNOWN_CVE_PKG_MAP_DIR + '%s_cve_pkg_match_result_%s.json'
DR009_JAVA_VERSIONS = DR009_KNOWN_CVE_PKG_MAP_DIR + 'versions_java.json'
DR009_JAVASCRIPT_VERSIONS = DR009_KNOWN_CVE_PKG_MAP_DIR + 'versions_javascript.json'
DR009_CVE_DATA_OF_COMMITS_PATH = DR009_KNOWN_CVE_PKG_MAP_DIR + 'cve_data_of_commits.json'

DR009_PACKAGE_MATCHER_LOG = 'log_package_matcher.log'
DR009_MATCHER_SERVER_LOG = 'log_package_matcher_server.log'
DR009_PKG_MATCHER_OUTPUT_PATH = OUTPUT_PATH + 'DR009/pkg_matcher/'


DR010_NVD_REF_ANALYSIS_DATA_PATH = OUTPUT_PATH + 'DR010/NVD_ref_anlysis_data.json'
DR010_RDG_COMMENTS_ANALYSIS_DATA_PATH = OUTPUT_PATH + 'DR010/RDG_comments_anlysis_data.json'
DR010_RDG_COMMENTS_ISSUE_FOR_PATCH_DATA_PATH  = OUTPUT_PATH + 'DR010/RDG_comments_issue_for_patch_analysis_data.json'
DR010_DEBIAN_NOTE_ANALYSIS_DATA_PATH = OUTPUT_PATH + 'DR010/Debian_note_anlysis_data.json'
DR010_DEBIAN_NOTE_ISSUE_FOR_PATCH_DATA_PATH  = OUTPUT_PATH + 'DR010/Debian_note_issue_for_patch_analysis_data.json'
DR010_REDHAT_EXTENDED_CVEIDS_REPORTS_PATH = OUTPUT_PATH + 'DR010/redhat_extended_CVEIDs_reports.json'
DR010_NVD_REF_PATCH_FOR_PATCH_DATA_PATH = OUTPUT_PATH + 'DR010/NVD_ref_Patch_for_patch_analysis_data.json'
DR010_NVD_REF_ISSUE_FOR_PATCH_DATA_PATH  = OUTPUT_PATH + 'DR010/NVD_ref_issue_for_patch_analysis_data.json'
DR010_NVD_REF_VADVISORY_FOR_PATCH_DATA_PATH  = OUTPUT_PATH + 'DR010/NVD_ref_Vadvisory_for_patch_analysis_data.json'
DR010_NVD_REF_VADVISORY_ISSUE_FOR_PATCH_DATA_PATH  = OUTPUT_PATH + 'DR010/NVD_ref_Vadvisory_issue_for_patch_analysis_data.json'

# svn_git_id
DR010_SVN_GIT_ID_DICT_PATH  = OUTPUT_PATH + 'DR010/svn_git_id/SVN_Git_ID.json'
DR010_CVE_SVN_GIT_ID_DICT_PATH  = OUTPUT_PATH + 'DR010/svn_git_id/CVE_SVN_Git_ID.json'


# known patch_ground_truth
DR010_PATCH_GROUND_TRUTH_DIR = OUTPUT_PATH + 'DR010/known_patch_ground_truth/'
DR010_VERACODEDB_PATCH_GROUND_TRUTH_PATH = DR010_PATCH_GROUND_TRUTH_DIR + 'VeracodeDB_patch_ground_truth.json'
DR010_SNYKDB_PATCH_GROUND_TRUTH_PATH = DR010_PATCH_GROUND_TRUTH_DIR + 'SnykDB_patch_ground_truth.json'
DR010_HW_PATCH_GROUND_TRUTH_PATH = DR010_PATCH_GROUND_TRUTH_DIR + 'HW_patch_ground_truth.json'
DR010_HW_PATCH_GROUND_TRUTH_PATH_TEM = DR010_PATCH_GROUND_TRUTH_DIR + 'HW_patch_ground_truth_201227.json'
DR010_FDSE_PATCH_GROUND_TRUTH_PATH = DR010_PATCH_GROUND_TRUTH_DIR + 'FDSE_patch_ground_truth.json'
DR010_FDSEP_PATCH_GROUND_TRUTH_PATH = DR010_PATCH_GROUND_TRUTH_DIR + 'FDSE+_patch_ground_truth.json'
DR010_TEST_PATCH_COLLECTER_RESULT = OUTPUT_PATH + 'DR010/patch_evaluation/patch_collection_result_%s_%s.json'
DR010_TEST_PATCH_COLLECTER_RESULT_VS_SPECIFIC_GROUND_TRUTH = OUTPUT_PATH + 'DR010/patch_evaluation/patch_collection_result_%s_VS_%s.json'
DR010_GATHERED_PATCH_COLLECTER_RESULT = OUTPUT_PATH + 'DR010/patch_evaluation/gathered_patch_collection_result.json'
DR010_GATHERED_PATCH_COLLECTER_RESULT_BY_VOTING = OUTPUT_PATH + 'DR010/patch_evaluation/gathered_patch_collection_result_by_voting.json'
DR010_GATHERED_PATCH_COLLECTER_RESULT_WITH_SRC = OUTPUT_PATH + 'DR010/patch_evaluation/gathered_patch_collection_result_with_src.json'

# search github
DR010_REQUEST_PULL_REQUESTS_DIR = OUTPUT_PATH + 'DR010/search_github/pull_requests/'
DR010_REQUEST_ISSUES_FOR_COMMITS_DIR = OUTPUT_PATH + 'DR010/search_github/target_issues/'
DR010_LIST_BRANCHES_OF_A_REPO_DIR = OUTPUT_PATH + 'DR010/search_github/branches_of_a_repo/'
DR010_LIST_BRANCHES_OF_A_REPO_GATHERED_CONTENT_PATH = DR010_LIST_BRANCHES_OF_A_REPO_DIR + '%s/gathered_page_content.json'
DR010_LIST_COMMITS_WITH_PARAMETERS_DIR = OUTPUT_PATH + 'DR010/search_github/list_commits_with_parameters/'
DR010_LIST_COMMITS_WITH_PARAMETERS_GATHERED_CONTENT_PATH = DR010_LIST_COMMITS_WITH_PARAMETERS_DIR + '%s/gathered_page_content.json'


DR010_SEACH_GITHUB_COMMITS_QUERY_DIR = OUTPUT_PATH + 'DR010/search_github/commits/query_message/'
DR010_SEACH_GITHUB_COMMITS_QUERY_MESSAGE_DIR = OUTPUT_PATH + 'DR010/search_github/commits/query_message/%s/'
DR010_SEACH_GITHUB_COMMITS_QUERY_MESSAGE_GATHERED_CONTENT_PATH = DR010_SEACH_GITHUB_COMMITS_QUERY_MESSAGE_DIR + 'gathered_page_content.json'

DR010_SEACH_GITHUB_CODE_QUERY_DIR = OUTPUT_PATH + 'DR010/search_github/code/query_message/'
DR010_SEACH_GITHUB_CODE_QUERY_MESSAGE_DIR = OUTPUT_PATH + 'DR010/search_github/code/query_message/%s/'
DR010_SEACH_GITHUB_CODE_QUERY_MESSAGE_GATHERED_CONTENT_PATH = DR010_SEACH_GITHUB_COMMITS_QUERY_MESSAGE_DIR + 'gathered_page_content.json'

DR010_SEACH_GITHUB_COMMITS_DIR = OUTPUT_PATH + 'DR010/search_github/commits/git_repos/'
DR010_SEACH_GITHUB_COMMITS_CVE_DIR = OUTPUT_PATH + 'DR010/search_github/commits/git_repos/%s/'
DR010_SEACH_GITHUB_COMMITS_CVE_GATHERED_CONTENT_PATH = DR010_SEACH_GITHUB_COMMITS_CVE_DIR + 'gathered_page_content.json'

DR010_SEACH_GITHUB_ISSUE_FOR_COMMITS_DIR = OUTPUT_PATH + 'DR010/search_github/issues/git_repos/'
DR010_SEACH_GITHUB_ISSUE_FOR_COMMITS_CVE_DIR = OUTPUT_PATH + 'DR010/search_github/issues/git_repos/%s/'
DR010_SEACH_GITHUB_ISSUE_FOR_COMMITS_CVE_GATHERED_CONTENT_PATH = DR010_SEACH_GITHUB_ISSUE_FOR_COMMITS_CVE_DIR + 'gathered_page_content.json'

DR010_SEARCH_GITHUB_FOR_COMMITS_DATA_PATH = OUTPUT_PATH + 'DR010/search_github/commits/GITHUB_searchfor_commits_data.json'
DR010_SEARCH_GITHUB_ISSUE_FOR_COMMITS_DATA_PATH = OUTPUT_PATH + 'DR010/search_github/issues/GITHUB_search_issues_for_commits_data.json'

DR010_GIT_COMMITS_META_RAW_DIR = OUTPUT_PATH+'DR010/git_commits_meta/raw/'
DR010_GIT_COMMITS_META_PROCESSED_DIR = OUTPUT_PATH+'DR010/git_commits_meta/processed/'

# for debug
# PATCH_LOCALICATION_OUTPUT_CVE_PATCH_OBJ_PATH = PATCH_LOCALICATION_OUTPUT_CVE_PATCH_OBJ_PATH.replace('mirror','gitrepo')
# PATCH_LOCALICATION_OUTPUT_CVE_GRAPH_PATH = PATCH_LOCALICATION_OUTPUT_CVE_GRAPH_PATH.replace('mirror','gitrepo')
# PATCH_LOCALICATION_OUTPUT_CVE_EXE_LOG_PATH = PATCH_LOCALICATION_OUTPUT_CVE_EXE_LOG_PATH.replace('mirror','gitrepo')
#
# DR010_GIT_COMMITS_META_RAW_DIR = DR010_GIT_COMMITS_META_RAW_DIR.replace('mirror','gitrepo')
# DR010_GIT_COMMITS_META_PROCESSED_DIR = DR010_GIT_COMMITS_META_PROCESSED_DIR.replace('mirror','gitrepo')
#
# DR010_SEACH_GITHUB_COMMITS_QUERY_DIR = DR010_SEACH_GITHUB_COMMITS_QUERY_DIR.replace('mirror','gitrepo')
# DR010_SEACH_GITHUB_COMMITS_QUERY_MESSAGE_DIR = DR010_SEACH_GITHUB_COMMITS_QUERY_MESSAGE_DIR.replace('mirror','gitrepo')
# DR010_SEACH_GITHUB_COMMITS_QUERY_MESSAGE_GATHERED_CONTENT_PATH = DR010_SEACH_GITHUB_COMMITS_QUERY_MESSAGE_GATHERED_CONTENT_PATH.replace('mirror','gitrepo')

# DR010_LIST_BRANCHES_OF_A_REPO_DIR = DR010_LIST_BRANCHES_OF_A_REPO_DIR.replace('mirror','gitrepo')
DR010_LIST_BRANCHES_OF_A_REPO_GATHERED_CONTENT_PATH = DR010_LIST_BRANCHES_OF_A_REPO_DIR + '%s/gathered_page_content.json'
# DR010_LIST_COMMITS_WITH_PARAMETERS_DIR = DR010_LIST_COMMITS_WITH_PARAMETERS_DIR.replace('mirror','gitrepo')
DR010_LIST_COMMITS_WITH_PARAMETERS_GATHERED_CONTENT_PATH = DR010_LIST_COMMITS_WITH_PARAMETERS_DIR + '%s/gathered_page_content.json'



DR010_COLLECTED_GIT_DATA_PATH =  PROJECT_ROOT + 'data/' + 'Git/' + 'collected_git_data.json'
# ================= crawled dataset ====================
# crawled dataset
## REDHAT
CRAWLED_REDHAT_VULNERABILITIES_DIR = OUTPUT_PATH + 'crawled_data/REDHAT/vulnerabilitis/'
CRAWLED_REDHAT_VULNERABILITY_COMMENTS_DIR = OUTPUT_PATH + 'crawled_data/REDHAT/vulnerability_comments/'
CRAWLED_REDHAT_VULNERABILITIES_ITEM_PATH = OUTPUT_PATH + 'crawled_data/REDHAT/vulnerabilitis/%s.json'
CRAWLED_REDHAT_VULNERABILITIES_WEBHTML_ITEM_PATH = OUTPUT_PATH + 'crawled_data/REDHAT/vulnerability_webhtml/%s.html'
CRAWLED_REDHAT_VULNERABILITY_COMMENTS_ITEM_PATH = OUTPUT_PATH + 'crawled_data/REDHAT/vulnerability_comments/%s_comments.json'

# debug时，进行切换
# CRAWLED_REDHAT_VULNERABILITIES_WEBHTML_ITEM_PATH = CRAWLED_REDHAT_VULNERABILITIES_WEBHTML_ITEM_PATH.replace('mirror','gitrepo')

CRAWLED_READHAT_ADVISORY_LIST_PAGE_PATH = OUTPUT_PATH + 'crawled_data/REDHAT/crawled_advisory_list_page.json'
CRAWLED_READHAT_ADVISORIES_PATH = OUTPUT_PATH + 'crawled_data/REDHAT/advisories/%s.html'
CRAWLED_READHAT_ADVISORIES_FOLDER = OUTPUT_PATH + 'crawled_data/REDHAT/advisories/'

CRAWLED_READHAT_FORMAL_ADVISORIES_INFO_PATH = OUTPUT_PATH + 'crawled_data/REDHAT/formal_advisories_info.json'
CRAWLED_READHAT_CVE_AFFECTEDPACKAGR_MAP_PATH = OUTPUT_PATH + 'crawled_data/REDHAT/cve_affectedPackage_map.json'

## GENTOO
CRAWLED_GENTOO_VULNERABILITIES_DIR = OUTPUT_PATH + 'crawled_data/GENTOO/vulnerabilities/'
CRAWLED_GENTOO_VULNERABILITY_COMMENTS_DIR = OUTPUT_PATH + 'crawled_data/GENTOO/vulnerability_comments/'
CRAWLED_GENTOO_VULNERABILITIES_ITEM_PATH = OUTPUT_PATH + 'crawled_data/GENTOO/vulnerabilities/%s.json'
CRAWLED_GENTOO_VULNERABILITY_COMMENTS_ITEM_PATH = OUTPUT_PATH + 'crawled_data/GENTOO/vulnerability_comments/%s_comments.json'

CRAWLED_GENTOO_VULNERABILITY_MAP_PATH = OUTPUT_PATH + 'crawled_data/GENTOO/cve_affectedPackage_map.json'
CRAWLED_GENTOO_ADVISORY_LIST_PAGE_PATH = OUTPUT_PATH + 'crawled_data/GENTOO/crawled_advisory_list_page.json'
CRAWLED_GENTOO_ADVISORIES_PATH = OUTPUT_PATH + 'crawled_data/GENTOO/advisories/%s.html'
CRAWLED_GENTOO_ADVISORIES_FOLDER = OUTPUT_PATH + 'crawled_data/GENTOO/advisories/'
CRAWLED_GENTOO_FORMAL_ADVISORIES_INFO_PATH = OUTPUT_PATH + 'crawled_data/GENTOO/formal_gentoo_info.json'
CRAWLED_GENTOO_ATTACHMENT_INFO_PATH = OUTPUT_PATH + 'crawled_data/GENTOO/crawled_attachment_info.json'
CRAWLED_GENTOO_FORMAL_ALL_INFORMATION = OUTPUT_PATH + 'crawled_data/GENTOO/formal_all_information.json'

## DEBIAN
CRAWLED_DEBIAN_ALL_INFO_JSON_FILE_PATH = OUTPUT_PATH + 'crawled_data/DEBIAN/crawled_debian_all_information.json'
CRAWLED_DEBIAN_ADVISORY_LIST_PAGE_PATH = OUTPUT_PATH + 'crawled_data/DEBIAN/crawled_advisory_list_page.json'
CRAWLED_DEBIAN_ADVISORY_LIST_PAGE_HTML_PATH = OUTPUT_PATH + 'crawled_data/DEBIAN/crawled_advisory_list_page.html'

CRAWLED_DEBIAN_ADVISORIES_PATH = OUTPUT_PATH + 'crawled_data/DEBIAN/advisories/%s.html'
CRAWLED_DEBIAN_VULNERABILITIES_ITEM_PATH = OUTPUT_PATH + 'crawled_data/DEBIAN/vulnerabilities/%s.html'

CRAWLED_DEBIAN_CVE_AFFECTEDPACKAGR_MAP_PATH = OUTPUT_PATH + 'crawled_data/DEBIAN/cve_affectedPackage_map.json'

## GITHUB
CRAWLED_GITHUB_ALL_INFO_JSON_PATH = OUTPUT_PATH + 'crawled_data/GITHUB/crawled_github_all_information.json'
CRAWLED_GITHUB_ADVISORY_DATABASE_PATH = OUTPUT_PATH + 'crawled_data/GITHUB/crawled_github_all_information.json'

# NER HW data
NER_HW_CORPUS_TO_ANNOTATE_PATH = OUTPUT_PATH + "ner_data/corpus_to_annotate_CVEDESC0812.txt"
NER_HW_REFERENCE_TO_ASSIST_ANNOTATION_PATH = OUTPUT_PATH + "ner_data/reference_to_assist_annotation_CVEDESC0814.json"

# cve references map
CVE_REFERENCES_MAP_DIR = OUTPUT_PATH + 'cve_references/'
CVE_REFERENCE_MAP_JSON_DIR = CVE_REFERENCES_MAP_DIR + 'json_get_by_allrefmaps/'

# extract cve html
EXTRACT_CVE_HTML_DIR = OUTPUT_PATH + 'processed_dataset/'
ORIGINAL_FORMAT_OF_CVES_DATA_PATH = EXTRACT_CVE_HTML_DIR + 'original_format_of_cves_data.json'
STATISTICAL_FORMAT_OF_CVES_DATA_PATH = EXTRACT_CVE_HTML_DIR + 'statistical_format_of_cves_data.json'

# process annotated corpus
ANNOTATED_NER_CORPUS_DIR = OUTPUT_PATH + 'ner_data/corpus/'
NER_RAW_DATA_PATH = ANNOTATED_NER_CORPUS_DIR + 'ner_raw_data.jsonl'
NER_DATA_SCN_PATH = ANNOTATED_NER_CORPUS_DIR + 'ner_data_SCN.json'
NER_DATA_SNNOCN_PATH = ANNOTATED_NER_CORPUS_DIR + 'ner_data_SNnoCN.json'
NER_DATA_SNWITHCN_PATH = ANNOTATED_NER_CORPUS_DIR + 'ner_data_SNwithCN.json'
NER_DATA_SCN_DUP_PATH = ANNOTATED_NER_CORPUS_DIR + 'SCN_dup.txt'
NER_DATA_SNNOCN_DUP_PATH = ANNOTATED_NER_CORPUS_DIR + 'SNnoCN_dup.txt'
NER_DATA_SNWITHCN_DUP_PATH = ANNOTATED_NER_CORPUS_DIR + 'SNwithCN_dup.txt'
NER_DATA_CORPUS_PATH = ANNOTATED_NER_CORPUS_DIR + 'corpus.txt'
NER_DATA_TRAIN_PATH = ANNOTATED_NER_CORPUS_DIR + 'train.txt'
NER_DATA_TRAIN_DUP_PATH = ANNOTATED_NER_CORPUS_DIR + 'train_dup.txt'
NER_DATA_VALIDATE_PATH = ANNOTATED_NER_CORPUS_DIR + 'validate.txt'
NER_DATA_VALIDTAE_DUP_PATH = ANNOTATED_NER_CORPUS_DIR + 'validate_dup.txt'
NER_DATA_TEST_PATH = ANNOTATED_NER_CORPUS_DIR + 'test.txt'
NER_DATA_TEST_DUP_PATH = ANNOTATED_NER_CORPUS_DIR + 'test_dup.txt'
# ================= dataset path ====================

# Ali 245 server
DATA_PATH = PROJECT_ROOT + 'data/'

CVE_DATASET_PATH = PROJECT_ROOT + 'data/CVE/'
print("CVE_DATASET_PATH: ",CVE_DATASET_PATH)

# CVE dataset
NVD_DATASET_DIR = CVE_DATASET_PATH + 'DataSet-NVD/'
NVD_DATASET_ITEMS_DIR = CVE_DATASET_PATH + 'DataSet-NVD/NVDItems/'
NVD_CPERANGE_ITEMS_DIR = CVE_DATASET_PATH + '/DataSet-NVD/NVDCpeRange/items/'
TEMPORARY_NVD_CVEID_LIST_PATH = DATA_PATH + 'NVD/NVD_CVEID_list.json'
NVD_CVEIDS_LIST_20200407_PATH = DATA_PATH + 'NVD/NVD_CVEID_list20200407.json'
NVD_CPE_RANGE_HTML_DIR = CVE_DATASET_PATH + "DataSet-NVD/NVDCpeRange/htmls/"
NVD_CPE_RANGE_ITEMS_DIR = CVE_DATASET_PATH + "DataSet-NVD/NVDCpeRange/items/"
NVD_NO_CPE_RANGE_LIST_PATH = CVE_DATASET_PATH + "DataSet-NVD/NVDCpeRange/NVD_NoCpeRange_list.json"

GITREPO_DIR = PROJECT_ROOT
OUTPUT_DIR = OUTPUT_PATH
VA_DIR = GITREPO_DIR + 'vulnerability_analysis/'
TRAIN_CORPUS_PATH = OUTPUT_PATH + 'ner_data/corpus/train.txt'
VALIDATE_CORPUS_PATH = OUTPUT_PATH + 'ner_data/corpus/validate.txt'
TEST_CORPUS_PATH = OUTPUT_PATH + 'ner_data/corpus/test.txt'
TRAINED_MODEL_PATH = VA_DIR + 'ner/TrainedModels/train_ner4scn_0914_1'
BERT_EMBED = VA_DIR + 'ner/BERT/multilingual_L-12_H-768_A-12/'

# ================= data path ====================
# ================= data path ====================
# Debian
DEBIAN_LIST_PATH = DATA_PATH + 'Debian/list'
DEBIAN_CVE_DATA_PATH = DATA_PATH + 'Debian/list_data.json'
DEBIAN_CVE_REPORT_LIST = DATA_PATH + 'Debian/list_tem.json'
# NVD
NVD_CVEID_LIST_PATH = DATA_PATH + 'NVD/NVD_CVEID_list.json'
# HW
HW_CVE_OSS_PAIRS_PATH = DATA_PATH + 'HW/cve-oss-pairs_previous.json'
HW_CVE_LIB_PAIRS_PATH = DATA_PATH + 'HW/cve-lib-pairs.json'
HW_CVEID_LIST_PATH = DATA_PATH + 'HW/HW_CVEID_list.json'
HW_CVE_FIX_DATA_PATH = DATA_PATH + 'HW/statistical_format_of_cves_fixes_data.json'
# Snyk
SNYK_CVEIDS_LIST_PATH = DATA_PATH + 'Snyk/Snyk_CVEID_list.json'
SNYK_CVE_SID_MAP_PATH = DATA_PATH + 'Snyk/LanguageCVESnykItemID_map.json'
SNYK_SID_ITEM_FOLDER_PATH = CVE_DATASET_PATH + "CrawledSnykHtmls/SnykItems/"
SNYK_KNOWN_CVE_OSS_PAIRS_PATH = DATA_PATH + 'Snyk/known_cve_oss_pair_from_snyk.json'
# Veracode
VERACODE_CVEIDS_LIST_PATH = DATA_PATH + 'Veracode/Veracode_CVEID_list.json'
VERACODE_CVE_SID_MAP = DATA_PATH + 'Veracode/LanguageCVEVearcodeItemSID_map.json'
VERACODE_SID_ITEM_FOLDER_PATH = CVE_DATASET_PATH + "CrawledVearCodeHtmls/VearCodeItems/"
VERACODE_KNOWN_CVE_OSS_PAIRS_PATH = DATA_PATH + 'Veracode/known_cve_oss_pair_from_veracode.json'
# OSS_meta
OSS_JAVA_MAVEN_CENTRAL_GA_LIST_PATH = DATA_PATH + 'open_source_components_meta/Java_maven_central_GA_list.json'
OSS_JS_NPM_CENTRAL_GA_LIST_PATH = DATA_PATH + 'open_source_components_meta/JS_npm_repo_list.json'
OSS_PYTHON_PYPI_CENTRAL_GA_LIST_PATH = DATA_PATH + 'open_source_components_meta/PYTHON_pypi_repo_list.json'
OSS_JAVA_MAVEN_CENTRAL_VERSION_LIST_PATH = DATA_PATH + 'open_source_components_meta/lib_versions.json'




# ================= tool path ====================
# ================= tool path ====================
TOOL_PATH = PROJECT_ROOT + 'tool/'
TOOL_PACKAGE_MATCHER_PATH = TOOL_PATH + 'PackageMatcher/package-matcher.jar'
TOOL_CVE_MATCHER_PATH = TOOL_PATH + 'CVEMatcher/cve-matcher.jar'

TOOL_CHROME_DRIVER = TOOL_PATH + 'chromedriver'


# ================= data template ====================
DR008_PRESENTED_METADTA_LIST = ["CVEID", 'CWE', 'Description', 'PublishedData', 'LastModifiedDate',
                                'AffectedVendorProductCPE', 'AffectedVendorProductVersionCPE',
                                'Reference', 'CVSS2', 'CVSS3', 'CVSS2Vector', 'CVSS3Vector']
# NVD_REFERENCE_TAG_LIST = [ 'Press/Media Coverag', 'Tool Signature', 'US Government Resourc', 'Issue Tracking', 'Mailing List', 'Tool Signatur', 'Vendor Advisory', 'Permissions Required', 'VDB Entry', 'Permissions Requir', 'Not Applicable', 'Not Applicabl', 'Release Not', 'Exploit', 'Technical Description', 'Release Notes', 'Mitigation', 'Product', 'Broken Link', 'Patch', 'Third Party Advisory']

NVD_REFERENCE_TAG_LIST = ['Mitigation', 'Patch', 'Press/Media Coverag', 'US Government Resourc', 'Release Notes',
                          'Third Party Advisory', 'Exploit', 'Technical Description', 'Not Applicabl', 'Tool Signatur',
                          'VDB Entry', 'Vendor Advisory', 'US Government Resource', 'Issue Tracking', 'Release Not',
                          'Permissions Requir', 'Not Applicable', 'Permissions Required', 'Broken Link', 'Mailing List',
                          'Product', 'Press/Media Coverage', 'Tool Signature']

# to delete
# ================= ner server url ====================
# =================  split str  ====================
L1_SPLITE_STR = '__fdse__'
L2_SPLITE_STR = '$_fdse_$'

# =================   url  ====================
## redhat
URL_REDHAT_BUG_WEBSITE = 'https://bugzilla.redhat.com/show_bug.cgi?id=%s' # https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2007-2878
URL_REDHAT_BUG = 'https://bugzilla.redhat.com/rest/bug/%s'  # https://bugzilla.redhat.com/rest/bug/1311089
URL_REDHAT_BUG_COMMENTS = 'https://bugzilla.redhat.com/rest/bug/%s/comment'  # https://bugzilla.redhat.com/rest/bug/1311089/comment
URL_REDHAT_ADVISORY_LIST_PAGE = 'https://api.access.redhat.com/rs/search?facet=true&facet.field=portal_severity&facet.field=portal_advisory_type&facet.mincount=1&facet.range=%7B!ex%3Date%7Dportal_publication_date&facet.range.end=NOW&facet.range.gap=%2B1YEAR&facet.range.start=NOW%2FYEAR-20YEARS&fl=id,portal_severity,portal_advisory_type,portal_product_names,portal_publication_date,portal_synopsis,view_uri,allTitle&fq=documentKind:(%22Errata%22)+AND+portal_advisory_type:(%22Security+Advisory%22)&fq=portal_product_filter:*%7C*&hl=true&hl.fl=abstract&hl.simple.post=%253C%252Fmark%253E&hl.simple.pre=%253Cmark%253E&p=1&q=*:*&sort=portal_publication_date+desc&start=0'

## gentoo
URL_GENTOO_BUG = 'https://bugs.gentoo.org/rest/bug/%s'
URL_GENTOO_BUG_COMMENTS = 'https://bugs.gentoo.org/rest/bug/%s/comment'
URL_GENTOO_BUG_HTML = "https://bugs.gentoo.org/%s"

## debian
URL_DEBIAN_BUG = 'https://security-tracker.debian.org/tracker/%s'
URL_DEBIAN_ALL_INFO_JSON_FILE = 'https://security-tracker.debian.org/tracker/data/json'
URL_DEBIAN_ADVISORY_LIST_PAGE = 'https://www.debian.org/security/crossreferences'

## github
URL_GITHUB_GRAPHQL = "https://api.github.com/graphql"
URL_GITHUB_PULL_REQUEST = "https://api.github.com/repos/%s/%s/pulls/%s"
URL_GITHUB_ISSUE = "https://api.github.com/repos/%s/%s/issues/%s"
URL_GITHUB_COMMIT = "https://api.github.com/repos/%s/%s/commits/%s"

# =================   data set  ====================
NER_PATH = PROJECT_ROOT + 'vulnerability_analysis/ner/'

DATASET_FOLDER = NER_PATH + 'Dataset/ner_data/'
DATASET_RESULT = NER_PATH + 'Dataset/ner_data/integrated_dataset/'

NER_MODEL_FOLDER = NER_PATH + 'TrainedModels/'
# NER_MODEL_DATA_FOLDER = PROJECT_ROOT + 'saved_ner_model'




#########################################################
################ patch localization######################

PATCH_LOCALIZATION_EXPERIMENTAL_CVEIDS_WITH_PATCH = DATA_PATH + 'patch_localization/experimental_CVEIDs_with_VulDB_patch.json'
PATCH_LOCALIZATION_EXPERIMENTAL_CVEIDS_WITHOUT_PATCH = DATA_PATH + 'patch_localization/experimental_CVEIDs_without_VulDB_patch.json'
PATCH_LOCALIZATION_EXPERIMENTAL_CVEIDS_WITH_PATCH_IN_ONLY_ONE_DB = DATA_PATH + 'patch_localization/experimental_CVEIDs_with_VulDB_patch_in_only_one_DB.json'

PATCH_LOCALIZATION_EXPERIMENTAL_CVEIDS_WITH_PATCH_IN_ONLY_ONE_DB_LOCALIZED_PATCH_LIST = DATA_PATH + 'patch_localization/disordered_CVE_patch_pairs_3000+_CVEID_list0412.json'
PATCH_LOCALIZATION_EXPERIMENTAL_CVEIDS_WITHOUT_PATCH_LOCALIZED_PATCH_LIST = DATA_PATH + 'patch_localization/disordered_CVE_patch_pairs_5000+_CVEID_list0412.json'


PATCH_LOCALIZATION_EXPERIMENTAL_CVEIDS_WITH_PATCH_EXCLUDING_LY = DATA_PATH + 'patch_localization/experimental_CVEIDs_list_with_VulDB_patch_excluding_LY.json'
LY_GT_CVEID_LIST_WITH_VULDB_PATCH = DATA_PATH + 'patch_localization/LY_GT_CVEID_list_with_VulDB_patch.json'
LY_CVEID_LIST_PATH = DATA_PATH + 'patch_localization/LY_CVEID_list.json'
PATCH_LOCALIZATION_OUR_PRE_TOOL_PATCH_RESULT = DATA_PATH + 'patch_localization/experimental_CVEIDs_with_VulDB_patch_our_tool_result.json'